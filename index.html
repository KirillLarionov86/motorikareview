<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Перенаправление...</title>
</head>
<body>
    <p id="message">Перенаправляем вас на страницу отзывов...</p>
    <script>
        // Получаем параметры из URL
        const urlParams = new URLSearchParams(window.location.search);
        const shopId = urlParams.get('shop_id');
        const employeeId = urlParams.get('employee_id');

        // Проверяем наличие shop_id
        if (!shopId) {
            console.error("Ошибка: параметр 'shop_id' отсутствует в URL.");
            document.getElementById('message').textContent = "❌ Ошибка: Параметр 'shop_id' отсутствует в URL.";
            return;
        }

        // **Правильные ссылки для отзывов**
        const reviewsUrl = {
            "1": "https://yandex.ru/maps/org/petrov_jewelry_watch/202367052946/reviews/",
            "2": "https://yandex.ru/maps/org/petrov_jewelry_watch/98434987667/reviews/",
            "3": "https://yandex.ru/maps/org/petrov_jewelry_watch/197362536275/reviews/"
        };

        // Проверяем, что shop_id существует в объекте reviewsUrl
        if (!reviewsUrl[shopId]) {
            console.error(`Ошибка: shop_id=${shopId} не найден в списке доступных магазинов.`);
            document.getElementById('message').textContent = `❌ Ошибка: shop_id=${shopId} не найден в списке доступных магазинов.`;
            return;
        }

        // Формируем правильную ссылку
        let redirectUrl = reviewsUrl[shopId];

        // **Фиксация перехода в Яндекс.Метрике**
        if (employeeId) {
            ym(80551024, 'reachGoal', 'review_redirect', { employee_id: employeeId, shop_id: shopId });
        }

        // **Выводим ссылку в консоль для проверки**
        console.log("Редирект на:", redirectUrl);

        // **Гарантированный редирект**
        window.location.href = redirectUrl;
    </script>
</body>
</html>
