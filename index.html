<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Перенаправление...</title>
    <script>
        // Получаем параметры из URL
        const urlParams = new URLSearchParams(window.location.search);
        const shopId = urlParams.get('shop_id');
        const employeeId = urlParams.get('employee_id');

        // Настраиваем ссылки на отзывы для каждой мастерской
        const reviews = {
            "1": "https://yandex.ru/maps/org/petrov_jewelry_watch/202367052946/reviews/?ll=30.433014%2C59.941055&mode=search&ncrnd=1",
            "2": "https://yandex.ru/maps/org/petrov_jewelry_watch/98434987667/reviews/?ll=30.280868%2C59.990920&mode=search&ncrnd=1",
            "3": "https://yandex.ru/maps/org/petrov_jewelry_watch/197362536275/reviews/?ll=30.448774%2C60.031971&mode=search&ncrnd=1"
        };

        // Определяем ссылку на отзывы (по умолчанию — главная Яндекс.Карт)
        let redirectUrl = reviews[shopId] || "https://yandex.ru/maps?ncrnd=1";

        // Фиксация события в Яндекс Метрике (если есть `employee_id`)
        if (employeeId) {
            ym(80551024, 'reachGoal', 'review_redirect', { employee_id: employeeId, shop_id: shopId });
        }

        // Попытка редиректа через `intent://` (Android)
        let androidIntent = `intent://${redirectUrl.replace('https://', '')}#Intent;scheme=https;package=ru.yandex.yandexmaps;end;`;

        // Пробуем сначала открыть приложение (Android)
        setTimeout(() => {
            window.location.href = androidIntent;
        }, 500);

        // Если через 2 секунды не сработало – открываем обычный браузер
        setTimeout(() => {
            window.location.href = redirectUrl;
        }, 2000);
    </script>
</head>
<body>
    <p>Перенаправляем вас на страницу отзывов...</p>
</body>
</html>
